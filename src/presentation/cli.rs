use clap::{arg, Command};

pub struct CliArgs {
    pub timeout: i32,
    pub level: usize,
    pub freq: f32,
    pub sound: bool,
}

pub fn parse_args() -> CliArgs {
    let matches = Command::new("rtyping")
        .author("Tomokatsu Kumata")
        .about("R-Typing: A terminal-based typing practice app.")
        .arg(
            arg!(-t --timeout <TIMEOUT> "Seconds")
                .default_value("60")
                .value_parser(clap::value_parser!(i32)),
        )
        .arg(
            arg!(-l --level <LEVEL> "Number of words")
                .default_value("30")
                .value_parser(clap::value_parser!(usize)),
        )
        .arg(
            arg!(--freq <FREQUENCY> "Frequency e.g, 800.0 or 480.0")
                .default_value("800.0")
                .value_parser(clap::value_parser!(f32)),
        )
        .arg(arg!(-s --sound "Enable BGM"))
        .get_matches();

    CliArgs {
        timeout: *matches.get_one::<i32>("timeout").expect("expect number"),
        level: *matches.get_one::<usize>("level").expect("expect number"),
        freq: *matches.get_one::<f32>("freq").expect("expect frequency"),
        sound: matches.get_flag("sound"),
    }
}
